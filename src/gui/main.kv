#:import CONF util.CONF
#:import STRINGS util.STRINGS

<View>:
    id: view
    orientation: 'vertical'
    
    canvas.before:
        Color:
            rgba: CONF["colors"]["background"]
        Rectangle:
            pos: self.pos
            size: self.size
    
    BoxLayout:
        orientation: 'horizontal'
        size_hint_y: None
        height: 25
        
        Button:
            id: 'new'
            text: STRINGS["menu"][0][app.lang]
            size_hint: None, None
            size: 200, 25
            font_size: 18
            background_color: CONF["colors"]["menu"]            
            on_release: root.controller.new_file_popup()
            
        Button:
            id: 'open'
            text: STRINGS["menu"][1][app.lang]
            size_hint: None, None
            size: 200, 25
            font_size: 18
            background_color: CONF["colors"]["menu"]
            on_release: root.controller.open_file_popup()
    
    ScrollView:
        id: scroll
        do_scroll_x: False
        do_scroll_y: True
        bar_width: 10
        scroll_timeout: 1000
        effect_cls: 'ScrollEffect'
        
        TagTree:
            id: tree
            size_hint_y: None
            hide_root: True
            
<EntNode>:
    cols: 1
    height: self.minimum_height
    orientation: 'lr-tb'
    color_selected: CONF["colors"]["selected_node"]    
    even_color: CONF["colors"]["background"]
    odd_color: CONF["colors"]["background_odd"]
            
    Label:
        id: label
        font_size: 15
        size_hint_y: None
        text_size: self.width, None
        width: 500
        height: self.texture_size[1]
        padding: (2, 2)

<EntryNode>
    rows: 3
    
    Label:
        id: comment
        font_size: 15
        size_hint: None, None
        size: self.texture_size
        padding: (2, 2)
    
    Label:
        id: reference
        font_size: 15
        size_hint: None, None
        size: self.texture_size
        padding: (2, 2)

<TagNode>:    
    cols: 2
    even_color: CONF["colors"]["tag_background"]
    odd_color: CONF["colors"]["tag_background"]    
    
    TextInput:
        id: input
        multiline: False
        on_text_validate: root.edit_done()
        font_size: 15
        size_hint_y: None
        height: 22
        padding: [2, 2, 2, 2]
        background_color: CONF["colors"]["input_background"]
        
<BasePopup>:
    title: ""
    separator_height: 0
    size_hint: None, None
    size: 400, 200
    on_open: self.focus = True
    dirselect: True

    GridLayout:
        cols: 1
        rows: 2
        size_hint: None, None
        size: root.size
    
        Label:
            id: label
            font_size: 15
            text_size: self.size
            valign: 'middle'
            padding: 20, 20
            
        AnchorLayout
            size_hint: 1, None
            height: 25
            
            Button:
                id: ok_button
                text: STRINGS["popup"][1][app.lang]
                size_hint: None, None
                size: 75, 25
                on_release: root.ok()
                
<NewFile>:
    title: STRINGS["filechooser"][0][app.lang]
    separator_height: 0
    on_open: self.focus = True
    dirselect: True
    
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: 'vertical'
    
        FileChooserListView:
            id: filechooser

        Label:
            id: file_name_caption
            size_hint: None, None
            width: self.texture_size[0]
            height: 25
            font_size: 17
            text: STRINGS["filechooser"][7][app.lang]

        TextInput:
            id: file_name
            size_hint_y: None
            height: 25
            multiline: False  
            font_size: 17
            padding: [2, 2, 2, 2]
            background_color: CONF["colors"]["input_background"]
        
        BoxLayout:
            size_hint_y: None
            height: 25
            orientation: 'horizontal'
        
            Button:
                id: cancel
                text: STRINGS["filechooser"][4][app.lang]
                on_release: root.close()
                
            Button:
                id: new
                text: STRINGS["filechooser"][2][app.lang]
                on_release: root.act(filechooser.path, file_name.text)
    
<OpenFile>:
    title: STRINGS["filechooser"][1][app.lang]
    separator_height: 0
    on_open: self.focus = True
    
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: 'vertical'
        
        FileChooserListView:
            id: filechooser
        
        BoxLayout:
            size_hint_y: None
            height: 25
            orientation: 'horizontal'
            
            Button:
                id: cancel
                text: STRINGS["filechooser"][4][app.lang]
                on_release: root.close()
                
            Button:
                id: open
                text: STRINGS["filechooser"][3][app.lang]
                on_release: root.act(filechooser.path, filechooser.selection[0])